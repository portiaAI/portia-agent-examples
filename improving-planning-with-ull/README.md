# Improving Planning with User-Led Learning (ULL)

## Introduction

This project demonstrates Portia's User-Led Learning (ULL) feature, which allows agents to learn from example plans and improve their planning capabilities over time. By providing examples of well-structured plans, you can guide the agent to create more effective plans for similar tasks in the future.

The examples use a refund processing scenario to demonstrate how ULL can improve an agent's ability to handle complex workflows involving customer service, policy review, and payment processing.

For more information on what the scripts do and what they demonstrate, you should read the accompanying blog post. (To be linked once published.)

## Prerequisites

- A Portia AI API key.
- A Stripe test account and associated secret key.

## Getting Started

Each script can be run independently to see the progression of planning capabilities as more examples are provided.

You'll need a `.env` file configuring a `PORTIA_API_KEY` and `STRIPE_TEST_API_KEY`.
You can copy `.env.example` to `.env` and paste your keys into the file.
(Or you can set these environment variables in whichever way you prefer.)
The Stripe key must be a valid Stripe secret key, but can be a test key.
It is only used to interact with the MCP tool service to discover Stripe's available tools.

```sh
export PORTIA_API_KEY='prt-LrrnPyt.0n0TaRe4Lk3y'
export STRIPE_TEST_API_KEY='sk_test_12ab23cdAMB54supernotarealkey'
```

We recommend you use [`uv`](https://github.com/astral-sh/uv) to run these example scripts.
UV will handle locating or installing the appropriate version of Python,
creating a local virtualenv,
and installation of all the project's requirements.

If you have `uv` installed, you can run each script like this, without any other steps:

```sh
# Run the first example script:
uv run 01_ull_vague_prompt_no_examples.py
```

The scripts are designed to be run in order,
and most simply print out the plan that was generated by the sample code.
The script `04_ull_create_example_plans.py` is different,
in that it generates static plans and stores them in Portia's cloud storage.

## Understanding the code

This directory contains a series of scripts that progressively demonstrate how ULL works:

1. [01_ull_vague_prompt_no_examples.py](./01_ull_vague_prompt_no_examples.py) - Shows how Portia handles a vague prompt without any example plans, resulting in potentially suboptimal planning.

2. [02_ull_good_prompt_no_examples.py](./02_ull_good_prompt_no_examples.py) - Demonstrates how improving the prompt with more specific instructions can lead to better plans, even without examples.

3. [03_ull_static_example_plans.py](./03_ull_static_example_plans.py) - Introduces the concept of providing a static example plan to guide Portia's planning process.

4. [04_ull_create_example_plans.py](./04_ull_create_example_plans.py) - Shows how to create and store multiple example plans that can be used for future planning tasks.

5. [05_ull_vague_with_examples.py](./05_ull_vague_with_examples.py) - Demonstrates how even with a vague prompt, Portia can create effective plans by leveraging previously stored example plans.